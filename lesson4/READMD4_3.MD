我來幫您寫一個 Python 程式來掃描 `nat2.turbotech.com.tw` 的所有端口，查看哪些端口是開啟的。


[3 tools called]

我已經為您創建了一個完整的端口掃描程式！這個程式具有以下特點：

## 🔍 **程式功能**

### **主要特色：**
1. **多線程掃描** - 使用 `ThreadPoolExecutor` 提高掃描速度
2. **智能服務識別** - 自動識別常見端口的服務名稱
3. **分階段掃描** - 先掃描常用端口(1-1000)，再掃描完整範圍
4. **詳細輸出** - 顯示掃描進度和結果統計
5. **錯誤處理** - 包含完整的異常處理機制

### **程式結構：**

```python
class PortScanner:
    - __init__(): 初始化掃描器
    - scan_port(): 掃描單個端口
    - get_service_name(): 獲取服務名稱
    - scan_range(): 掃描端口範圍
```

## 🚀 **使用方法**

直接執行程式：
```bash
python lesson4_3.py
```

## 📊 **輸出範例**

程式會顯示：
- 掃描進度
- 發現的開啟端口
- 對應的服務名稱
- 掃描統計資訊

## ⚙️ **可調整參數**

- `timeout`: 連接超時時間（預設2秒）
- `max_threads`: 最大線程數（預設50-100）
- `start_port/end_port`: 掃描範圍

## ⚠️ **注意事項**

1. **網路掃描** - 請確保您有權限掃描目標主機
2. **防火牆** - 某些端口可能被防火牆阻擋
3. **掃描時間** - 完整掃描65535個端口需要較長時間
4. **資源使用** - 多線程會消耗較多網路資源

這個程式會先快速掃描常用端口，如果發現開啟的端口，再進行完整範圍的掃描，既節省時間又能提供完整的結果！